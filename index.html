<!DOCTYPE html>
<html lang="az">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Game Saray</title>

<style>
:root{
  --bg1:#00ffff;
  --bg2:#000;
  --card:#111;
  --text:#fff;
  --btn:#0ff;
}

body.dark{
  --bg1:#000;
  --bg2:#111;
  --card:#000;
  --text:#00ffff;
  --btn:#00aaaa;
}

body{
  margin:0;
  font-family:Arial, sans-serif;
  background: radial-gradient(circle at top, var(--bg1), var(--bg2));
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
  padding:20px;
  color:var(--text);
  transition:0.3s;
}

.toggleMode{
  position:fixed;
  top:10px;
  right:10px;
  padding:8px 15px;
  border:none;
  border-radius:10px;
  cursor:pointer;
  font-weight:bold;
}

.container{
  text-align:center;
  background:var(--card);
  padding:35px;
  border-radius:20px;
  box-shadow:0 0 30px var(--bg1);
  width:90%;
  max-width:420px;
}

input, select{
  padding:12px;
  font-size:16px;
  border-radius:12px;
  border:none;
  margin-bottom:10px;
  width:100%;
  text-align:center;
  background:#222;
  color:#0ff;
}

button{
  padding:12px;
  font-size:15px;
  border-radius:12px;
  border:none;
  cursor:pointer;
  background:var(--btn);
  color:#000;
  font-weight:bold;
  margin-top:5px;
  width:100%;
}

.hidden{display:none;}
.error{color:red;font-weight:bold;}

.processing{
  font-size:20px;
  animation:blink 1s infinite;
}

@keyframes blink{
  0%{opacity:1;}
  50%{opacity:0.3;}
  100%{opacity:1;}
}
</style>
</head>
<body>

<button class="toggleMode" onclick="toggleMode()">Dark / Light</button>

<div class="container" id="step1">
  <h2>KOD DAXİL ET</h2>
  <input type="text" id="codeInput" placeholder="Kod daxil et">
  <button onclick="checkCode()">KEÇİD ET</button>
  <div class="error" id="error1"></div>
</div>

<div class="container hidden" id="step2">
  <h2>UC SEÇ</h2>
  <select id="ucSelect">
    <option value="60 UC">60 UC</option>
    <option value="325 UC">325 UC</option>
    <option value="660 UC">660 UC</option>
    <option value="1800 UC">1800 UC</option>
  </select>
  <button onclick="confirmUC()">DAVAM ET</button>
</div>

<div class="container hidden" id="step3">
  <h2>QƏBZ ENDİR</h2>
  <button onclick="generateReceipt()">ENDİR</button>
</div>

<script>

let validCodes = JSON.parse(localStorage.getItem("validCodes")) || [
  "GAMESARAYMS0279",
  "GAMESARAY00186KK",
  "GAMESARAY196028CF"
];

function saveCodes(){
  localStorage.setItem("validCodes", JSON.stringify(validCodes));
}

function toggleMode(){
  document.body.classList.toggle("dark");
}

function checkCode(){
  const code = document.getElementById("codeInput").value.trim();
  if(!validCodes.includes(code)){
    document.getElementById("error1").innerText="Kod səhvdir!";
    return;
  }

  // Bir dəfəlik kod → silinir
  validCodes = validCodes.filter(c => c !== code);
  saveCodes();

  document.getElementById("step1").classList.add("hidden");
  document.getElementById("step2").classList.remove("hidden");
}

function confirmUC(){
  document.getElementById("step2").classList.add("hidden");
  document.getElementById("step3").classList.remove("hidden");
}

function generateReceipt(){

  document.getElementById("step3").innerHTML =
  "<div class='processing'>Processing...</div>";

  setTimeout(() => {

    const uc = document.getElementById("ucSelect").value;

    function randomCode(){
      const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
      let result="";
      for(let i=0;i<9;i++){
        result += chars.charAt(Math.floor(Math.random()*chars.length));
      }
      return result;
    }

    const receiptCode = randomCode();

    const canvas = document.createElement("canvas");
    canvas.width = 700;
    canvas.height = 400;
    const ctx = canvas.getContext("2d");

    ctx.fillStyle="#ffffff";
    ctx.fillRect(0,0,700,400);

    ctx.fillStyle="#000";
    ctx.font="bold 28px Arial";
    ctx.textAlign="center";
    ctx.fillText("GAME SARAY ƏMƏLİYYAT QƏBZİ",350,70);

    ctx.textAlign="left";
    ctx.font="20px Arial";
    ctx.fillText("Tarix: " + new Date().toLocaleString(),80,170);
    ctx.fillText("UC: " + uc,80,220);
    ctx.fillText("Qəbz Kodu: " + receiptCode,80,270);

    const link = document.createElement("a");
    link.download="GameSaray_Qebz.png";
    link.href=canvas.toDataURL("image/png");
    link.click();

    document.body.innerHTML =
    "<h2 style='text-align:center;color:#0ff;'>Əməliyyat tamamlandı.</h2>";

  }, 2500); // 2.5 saniyə fake bank effekti
}

</script>
</body>
</html>
