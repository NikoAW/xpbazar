<!DOCTYPE html>
<html lang="az">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Game Saray</title>

<style>
body{
  margin:0;
  font-family:Arial;
  background: radial-gradient(circle at top,#00ffff,#000);
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
  color:white;
}

.container{
  background:#111;
  padding:30px;
  border-radius:20px;
  box-shadow:0 0 25px cyan;
  width:95%;
  max-width:420px;
  text-align:center;
}

input,select,button{
  width:100%;
  padding:10px;
  margin:8px 0;
  border-radius:10px;
  border:none;
  text-align:center;
}

button{
  background:cyan;
  font-weight:bold;
  cursor:pointer;
}

.hidden{display:none;}

.processing{
  position:fixed;
  top:0;left:0;
  width:100%;height:100%;
  background:black;
  display:flex;
  justify-content:center;
  align-items:center;
  flex-direction:column;
  color:cyan;
  font-size:22px;
}

.helpBox{
  display:none;
  background:#0ff;
  color:#000;
  padding:10px;
  border-radius:10px;
  margin-top:5px;
  text-align:left;
}
.helpToggle{
  color:#0ff;
  cursor:pointer;
  margin-top:5px;
}
</style>
</head>
<body>

<div class="container" id="step1">
<h2>KOD DAXİL ET</h2>
<input type="text" id="codeInput">
<button onclick="checkCode()">KEÇİD ET</button>
<p id="error" style="color:red;"></p>

<p class="helpToggle" onclick="toggleHelp()">Necə sipariş vermək olar?</p>
<div id="helpBox" class="helpBox">
Tiktok vəya WhatsApp xəddi üzrə, operatorlarımız ilə əlaqə saxlayın. Canlı şəkildə kartla ödəniş edərək sizə özəl kod alın. Kodu buradakı bölməyə yazaraq “KEÇİD ET” düyməsinə basın. Sonra ID-nizi yazıb davam edin və sondakı çeki mütləq götürün. Siparişiniz avtomatik 5-10 dəqiqə ərzində başa çatacaq.
</div>

</div>

<div class="container hidden" id="step2">
<h2>PAKET SEÇ</h2>
<select id="ucSelect">
<option>660 UC</option>
<option>1920 UC</option>
<option>3120 UC</option>
<option>8100 UC</option>
<option>Royale Pass Plus 1-100</option>
</select>

<h2>OYUNÇU ID</h2>
<input type="text" id="playerID">
<button onclick="goReceipt()">DAVAM ET</button>
</div>

<div class="container hidden" id="step3">
<h2>QƏBZ ENDİR</h2>
<button onclick="generateReceipt()">ENDİR</button>
</div>

<script>

const validCodes = [
  "GAMESARAYMS0279",
  "VIP2026",
  "ROYAL100"
];

function processing(callback){
  const div=document.createElement("div");
  div.className="processing";
  div.innerHTML="Processing...";
  document.body.appendChild(div);

  setTimeout(()=>{
    document.body.removeChild(div);
    callback();
  },1000);
}

function toggleHelp(){
  const box=document.getElementById("helpBox");
  box.style.display = (box.style.display==="none" || box.style.display==="") ? "block" : "none";
}

function checkCode(){
  processing(()=>{
    const code=document.getElementById("codeInput").value.trim();

    if(validCodes.includes(code)){
      document.getElementById("step1").classList.add("hidden");
      document.getElementById("step2").classList.remove("hidden");
    }else{
      document.getElementById("error").innerText="Səfh kod!";
    }
  });
}

function goReceipt(){
  processing(()=>{
    const id=document.getElementById("playerID").value;

    if(id.length<5){
      alert("ID minimum 5 rəqəm olmalıdır");
      return;
    }

    document.getElementById("step2").classList.add("hidden");
    document.getElementById("step3").classList.remove("hidden");
  });
}

function generateReceipt(){
  processing(()=>{

    const realID=document.getElementById("playerID").value;
    const uc=document.getElementById("ucSelect").value;

    function randomCode(){
      const chars="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
      let r="";
      for(let i=0;i<8;i++){
        r+=chars.charAt(Math.floor(Math.random()*chars.length));
      }
      return r;
    }

    const receiptCode=randomCode();

    const canvas=document.createElement("canvas");
    canvas.width=700;
    canvas.height=400;
    const ctx=canvas.getContext("2d");

    ctx.fillStyle="#fff";
    ctx.fillRect(0,0,700,400);

    ctx.fillStyle="#000";
    ctx.font="bold 26px Arial";
    ctx.textAlign="center";
    ctx.fillText("XpBazar ƏMƏLİYYAT QƏBZİ",350,70);

    ctx.textAlign="left";
    ctx.font="20px Arial";
    ctx.fillText("Tarix: "+new Date().toLocaleString(),80,150);
    ctx.fillText("Oyunçu ID: "+realID,80,200); // İndi ID dəyişmir, tam yazdıqlarını göstərir
    ctx.fillText("Paket: "+uc,80,240);
    ctx.fillText("Qəbz Kodu: "+receiptCode,80,280);

    const link=document.createElement("a");
    link.download="XpBAZAR_Qebz.png";
    link.href=canvas.toDataURL();
    link.click();
  });
}

</script>
</body>
</html>
